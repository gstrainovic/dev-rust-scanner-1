📦 Loaded 604 compromised packages from /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/compromised-packages.txt
Starting Shai-Hulud detection scan...
Scanning directory: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project (with paranoid mode enabled)

🔍 Checking for malicious workflow files...
🔍 Checking 2 files for known malicious content...
[K0 / 2 checked (0 %)[K🔍 Checking 1 package.json files for compromised packages...
[K1 / 1 checked (100 %)[K🔍 Checking for suspicious postinstall hooks...
🔍 Checking for suspicious content patterns...
🔍 Checking for cryptocurrency theft patterns...
🔍 Checking for Trufflehog activity and secret scanning...
🔍 Checking for suspicious git branches...
🔍 Checking for Shai-Hulud repositories and migration patterns...
🔍 Checking package lock files for integrity issues...
🔍+ Checking for typosquatting and homoglyph attacks...
🔍+ Checking for network exfiltration patterns...

==============================================
  SHAI-HULUD + PARANOID SECURITY REPORT
==============================================

⚠️  MEDIUM RISK: Suspicious content patterns:
   - Pattern: webhook.site reference
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   - Pattern: malicious webhook endpoint
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   NOTE: Manual review required to determine if these are malicious.

🚨 HIGH RISK: Trufflehog/secret scanning activity detected:
   - Activity: Environment scanning with exfiltration
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js[0m
   [34m│  Context: HIGH RISK: Environment scanning with exfiltration[0m
   [34m└─[0m

   NOTE: These patterns indicate likely malicious credential harvesting.
   Immediate investigation and remediation required.

⚠️  MEDIUM RISK (PARANOID): Network exfiltration patterns detected:
   - Warning: Hardcoded IP addresses found: 192.168.1.100
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   - Warning: Suspicious domain found: webhook.site: fetch("https://webhook.site/bb8ca5f6-4175-45d2-b042-fc9ebb8170b7", {
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   - Warning: Base64 decoding at line: const secretEndpoint = atob(encodedUrl);
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   - Warning: WebSocket connection to external endpoint: wss://evil.example.com/collect
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   - Warning: Suspicious HTTP headers detected
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/network-exfiltration-project/malicious.js
   - ... and 1 more network warnings (truncated for brevity)
   NOTE: These patterns may indicate data exfiltration or communication with C2 servers.
   Review network connections and data flows carefully.

==============================================
🔍 SUMMARY:
   High Risk Issues: 1
   Medium Risk Issues: 7
   Total Critical Issues: 8

⚠️  IMPORTANT:
   - High risk issues likely indicate actual compromise
   - Medium risk issues require manual investigation
   - Low risk issues are likely false positives from legitimate code
   - Issues marked (PARANOID) are general security checks, not Shai-Hulud specific
   - Consider running additional security scans
   - Review your npm audit logs and package history
==============================================
