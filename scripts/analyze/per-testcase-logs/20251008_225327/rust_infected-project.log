📦 Loaded 604 compromised packages from /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/compromised-packages.txt
Starting Shai-Hulud detection scan...
Scanning directory: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project

🔍 Checking for malicious workflow files...
🔍 Checking 5 files for known malicious content...
[K0 / 5 checked (0 %)[K🔍 Checking 1 package.json files for compromised packages...
[K1 / 1 checked (100 %)[K🔍 Checking for suspicious postinstall hooks...
🔍 Checking for suspicious content patterns...
🔍 Checking for cryptocurrency theft patterns...
🔍 Checking for Trufflehog activity and secret scanning...
🔍 Checking for suspicious git branches...
🔍 Checking for Shai-Hulud repositories and migration patterns...
🔍 Checking package lock files for integrity issues...

==============================================
      SHAI-HULUD DETECTION REPORT
==============================================

🚨 HIGH RISK: Malicious workflow files detected:
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/.github/workflows/shai-hulud-workflow.yml
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/.github/workflows/shai-hulud-workflow.yml[0m
   [34m│  Context: HIGH RISK: Known malicious workflow filename[0m
   [34m└─[0m

🚨 HIGH RISK: Compromised package versions detected:
   - Package: @ctrl/deluge@1.2.0
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/package.json
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/package.json[0m
   [34m│  Context: HIGH RISK: Contains compromised package version: @ctrl/deluge@1.2.0[0m
   [34m└─[0m

   - Package: @nativescript-community/ui-material-core@7.2.49
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/package.json
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/package.json[0m
   [34m│  Context: HIGH RISK: Contains compromised package version: @nativescript-community/ui-material-core@7.2.49[0m
   [34m└─[0m

   NOTE: These specific package versions are known to be compromised.
   You should immediately update or remove these packages.

⚠️  MEDIUM RISK: Suspicious content patterns:
   - Pattern: webhook.site reference
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/.github/workflows/shai-hulud-workflow.yml
   - Pattern: malicious webhook endpoint
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/.github/workflows/shai-hulud-workflow.yml
   - Pattern: webhook.site reference
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/actual-credential-harvester.js
   - Pattern: malicious webhook endpoint
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/actual-credential-harvester.js
   - Pattern: webhook.site reference
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious.js
   - Pattern: malicious webhook endpoint
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious.js
   - Pattern: webhook.site reference
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/package-with-postinstall.json
   - Pattern: malicious webhook endpoint
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/package-with-postinstall.json
   NOTE: Manual review required to determine if these are malicious.

🚨 HIGH RISK: Cryptocurrency theft patterns detected:
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/crypto-theft.js:XMLHttpRequest prototype modification with crypto patterns detected - HIGH RISK
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/crypto-theft.js:Known attacker wallet address detected - HIGH RISK
   NOTE: These patterns strongly indicate crypto theft malware from the September 8 attack.
   Immediate investigation and remediation required.

⚠️  MEDIUM RISK: Potential cryptocurrency manipulation patterns:
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/crypto-theft.js:Ethereum wallet address patterns detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/crypto-theft.js:Phishing domain npmjs.help detected
   NOTE: These may be legitimate crypto tools or framework code.
   Manual review recommended to determine if they are malicious.

🚨 HIGH RISK: Trufflehog/secret scanning activity detected:
   - Activity: Trufflehog binary found
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious-trufflehog-wrapper.sh
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious-trufflehog-wrapper.sh[0m
   [34m│  Context: HIGH RISK: Trufflehog binary found[0m
   [34m└─[0m

   - Activity: Trufflehog binary found
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/trufflehog-script.sh
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/trufflehog-script.sh[0m
   [34m│  Context: HIGH RISK: Trufflehog binary found[0m
   [34m└─[0m

   - Activity: Credential patterns with potential exfiltration
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious-trufflehog-wrapper.sh
   [34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious-trufflehog-wrapper.sh[0m
   [34m│  Context: HIGH RISK: Credential patterns with potential exfiltration[0m
   [34m└─[0m

   NOTE: These patterns indicate likely malicious credential harvesting.
   Immediate investigation and remediation required.

⚠️  MEDIUM RISK: Potentially suspicious secret scanning patterns:
   - Pattern: Contains credential scanning patterns
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/actual-credential-harvester.js
   - Pattern: Potentially suspicious environment variable access
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/actual-credential-harvester.js
   - Pattern: Contains trufflehog references in source code
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/malicious-trufflehog-wrapper.sh
   - Pattern: Contains trufflehog references in source code
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/trufflehog-script.sh
   - Pattern: Contains credential scanning patterns
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/trufflehog-script.sh
   - Pattern: Potentially suspicious environment variable access
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/infected-project/trufflehog-script.sh
   NOTE: These may be legitimate security tools or framework code.
   Manual review recommended to determine if they are malicious.

==============================================
🔍 SUMMARY:
   High Risk Issues: 8
   Medium Risk Issues: 16
   Low Risk (informational): 2
   Total Critical Issues: 24

⚠️  IMPORTANT:
   - High risk issues likely indicate actual compromise
   - Medium risk issues require manual investigation
   - Low risk issues are likely false positives from legitimate code
   - Consider running additional security scans
   - Review your npm audit logs and package history
==============================================
