[0;34m📦 Loaded 604 compromised packages from /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/compromised-packages.txt[0m
[0;32mStarting Shai-Hulud detection scan...[0m
[0;34mScanning directory: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack[0m

[0;34m🔍 Checking for malicious workflow files...[0m
[0;34m🔍 Checking 3 files for known malicious content...[0m
[K1 / 3 checked (33 %)[K2 / 3 checked (66 %)[K3 / 3 checked (100 %)[K[0;34m🔍 Checking 1 package.json files for compromised packages...[0m
[K1 / 1 checked (100 %)[K[0;34m🔍 Checking for suspicious postinstall hooks...[0m
[0;34m🔍 Checking for suspicious content patterns...[0m
[0;34m🔍 Checking for cryptocurrency theft patterns...[0m
[0;34m🔍 Checking for Trufflehog activity and secret scanning...[0m
[0;34m🔍 Checking for suspicious git branches...[0m
[0;34m🔍 Checking for Shai-Hulud repositories and migration patterns...[0m
[0;34m🔍 Checking package lock files for integrity issues...[0m

[0;34m==============================================[0m
[0;34m      SHAI-HULUD DETECTION REPORT[0m
[0;34m==============================================[0m

[0;31m🚨 HIGH RISK: Compromised package versions detected:[0m
   - Package: chalk@5.6.1
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/package.json
   [0;34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/package.json[0m
   [0;34m│  Context: HIGH RISK: Contains compromised package version: chalk@5.6.1[0m
   [0;34m└─[0m

   - Package: debug@4.4.2
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/package.json
   [0;34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/package.json[0m
   [0;34m│  Context: HIGH RISK: Contains compromised package version: debug@4.4.2[0m
   [0;34m└─[0m

   - Package: ansi-styles@6.2.2
     Found in: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/package.json
   [0;34m┌─ File: /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/package.json[0m
   [0;34m│  Context: HIGH RISK: Contains compromised package version: ansi-styles@6.2.2[0m
   [0;34m└─[0m

   [1;33mNOTE: These specific package versions are known to be compromised.[0m
   [1;33mYou should immediately update or remove these packages.[0m

[0;31m🚨 HIGH RISK: Cryptocurrency theft patterns detected:[0m
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/malicious-chalk.js:XMLHttpRequest prototype modification with crypto patterns detected - HIGH RISK
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/malicious-chalk.js:Known attacker wallet address detected - HIGH RISK
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/obfuscated-payload.js:Known attacker wallet address detected - HIGH RISK
   [0;31mNOTE: These patterns strongly indicate crypto theft malware from the September 8 attack.[0m
   [0;31mImmediate investigation and remediation required.[0m

[1;33m⚠️  MEDIUM RISK: Potential cryptocurrency manipulation patterns:[0m
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/malicious-chalk.js:Ethereum wallet address patterns detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/malicious-chalk.js:Known crypto theft function names detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/malicious-chalk.js:Phishing domain npmjs.help detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/malicious-chalk.js:Cryptocurrency regex patterns detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/obfuscated-payload.js:Ethereum wallet address patterns detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/obfuscated-payload.js:Phishing domain npmjs.help detected
   - /c/Users/gstra/Code/rust-scanner/shai-hulud-detect/test-cases/chalk-debug-attack/obfuscated-payload.js:JavaScript obfuscation detected
   [1;33mNOTE: These may be legitimate crypto tools or framework code.[0m
   [1;33mManual review recommended to determine if they are malicious.[0m

[0;34m==============================================[0m
[0;31m🔍 SUMMARY:[0m
[0;31m   High Risk Issues: 6[0m
[1;33m   Medium Risk Issues: 7[0m
[0;34m   Total Critical Issues: 13[0m

[1;33m⚠️  IMPORTANT:[0m
[1;33m   - High risk issues likely indicate actual compromise[0m
[1;33m   - Medium risk issues require manual investigation[0m
[1;33m   - Low risk issues are likely false positives from legitimate code[0m
[1;33m   - Consider running additional security scans[0m
[1;33m   - Review your npm audit logs and package history[0m
[0;34m==============================================[0m
